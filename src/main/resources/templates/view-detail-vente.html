<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	data-th-replace="~{layouts/layout :: layout-enchere(
			titrePage=~{:: title}, 
			contenuPage=~{:: main}, 
			ressourceSupp=~{})}"
>
<head>
<title data-th-text="#{view-detail-vente.title}"></title>
</head>
<body>
	<main class="main-detail-vente">
		<!-- SI ARTICLE NON TROUVE -->
		<th:block data-th-if="${error}">
			<h2 data-th-text="${error}"></h2>
		</th:block>
		<!-- SINON -->
		<th:block data-th-unless="${error}">
			<h2 data-th-text="${'Detail de la vente : ' +article.nom}">Détail d'une vente</h2>
			<div class="content-description-vente">
				<ul class="description-vente">
					<li data-th-text="#{view-detail-vente.article}">
						<span data-th-text="${article.nom}"></span>
					</li>
					<li data-th-text="#{view-detail-vente.categorie}">
						<span data-th-text="${article.categorie.libelle}"></span>
					</li>
					<li data-th-text="#{view-detail-vente.description}">
						<span data-th-text="${article.description}"></span>
					</li>
					<li data-th-text="#{view-detail-vente.adresse_retrait}">
						<span
							data-th-text="${article.adresseRetrait.rue +', '+ article.adresseRetrait.codePostal + ' ' + article.adresseRetrait.ville}"
						></span>
					</li>
					<li data-th-text="#{view-detail-vente.vendeur}">
						<span data-th-text="${article.vendeur.pseudo}"></span>
					</li>
				</ul>
				<ul class="detail-vente-detail">
					<li data-th-text="${article.vendeur.prix_initial}">
						<span data-th-text="${article.prixInitial +' point(s)'}"></span>
					</li>
					<li>
						Meilleure offre: <span data-th-text="${article.prixVente +' point(s)'}"></span>  <span data-th-if="${!#strings.isEmpty(enchere.acquereur.pseudo)}" data-th-text="'par ' + ${enchere.acquereur.pseudo}"></span>

					</li>
					<li>
						Fin de l'enchère: <span th:text="${#temporals.format(article.dateFinEncheres, 'dd/MM/yyyy')}"></span>
					</li>
				</ul>
			</div>
		<!-- SI UTILISATEUR CONNECTE DIFFERENT DU VENDEUR AFFICHER FORMULAIRE && CREDIT SUFFISANT -->	
		<th:block data-th-if="${!#strings.equals(article.vendeur.pseudo, #authentication.name)}">
			<form data-th-action="@{/encheres/detail}" method="post" class="form form-enchere" 
				data-th-if="${utilisateur.credit >= enchere.articleAVendre.prixVente + 1}"
				data-th-object="${enchere}">
				
				<input type="hidden" data-th-field="*{articleAVendre.id}">
				<div>
					<label>Mon enchère :</label>
					<input type="number" 
					th:min="${enchere.articleAVendre.prixVente + 1}" 
					th:max="${utilisateur.credit}"
					data-th-field="*{montant}"
					class="input">
				<input class="btnPrimaire" type="submit" value="Enchérir">
				</div>
			</form>
			<!-- SI PAS ASSEZ DE CREDIT -->
			<p class="warning" data-th-unless="${utilisateur.credit >= enchere.articleAVendre.prixVente + 1}">Vous n'avez pas assez de crédit
				pour enchérir &#128542;</p>
		</th:block>
		<a href="/" class="btnPrimaire btnSecondaire">Retourner à l'accueil</a>
	</main>

</body>
</html>
